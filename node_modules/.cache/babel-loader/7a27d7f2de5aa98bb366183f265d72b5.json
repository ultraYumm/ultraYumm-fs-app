{"ast":null,"code":"import _classCallCheck from\"/Users/Stephanie/coding/ultrayumm-fs-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Stephanie/coding/ultrayumm-fs-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/Stephanie/coding/ultrayumm-fs-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/Stephanie/coding/ultrayumm-fs-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'../Font/Font.css';import GoButton from'../FormElements/GoButton';import'../FormElements/FormElements.css';import{withRouter}from\"react-router-dom\";import config from\"../config\";import{TRIPS}from\"../Defaults\";import{Auth}from'aws-amplify';import Moment from'react-moment';var EditTripForm=/*#__PURE__*/function(_Component){_inherits(EditTripForm,_Component);var _super=_createSuper(EditTripForm);function EditTripForm(props){var _this;_classCallCheck(this,EditTripForm);_this=_super.call(this,props);var selectedTrip=_this.props.selectedTrip;_this.state={startDate:null,endDate:null,name:TRIPS[0].name,id:\"\",username:\"\",selectedTrip:selectedTrip.length===0?TRIPS[0]:selectedTrip};return _this;}_createClass(EditTripForm,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;Auth.currentAuthenticatedUser().then(function(user){var id=user.attributes.sub;var username=user.username;_this2.props.getUser(id,username);_this2.setState({id:id,username:username});});}},{key:\"render\",value:function render(){var _this3=this;var moment=require('moment');var re=/:\\s|\\s/;var userid=this.state.id;var onSubmitForm=function onSubmitForm(e){e.preventDefault();var iframe=e.target.tripURL.value;var tripName=e.target.tripName.value;var tripTravelers=e.target.tripTravelers.value.split(re);var getDates=function getDates(){var dateArray=[];var currentDate=moment(e.target.startDate.value);var endDate=moment(e.target.endDate.value);while(currentDate<=endDate){dateArray.push(moment(currentDate).format());currentDate=moment(currentDate).add(1,'d');}return dateArray;};var tripDates=[getDates()];var inputValues={name:tripName,iframe:iframe,traveler_names:tripTravelers,trip_dates:tripDates[0],userid:userid};var API=config.API_UY_ENDPOINT;var endpoint=config.endpointT;var url=API+endpoint+\"\".concat(_this3.state.selectedTrip[0].id);var API_TOKEN=config.API_UY_KEY;fetch(url,{method:_this3.props.method,body:JSON.stringify(inputValues),headers:{'content-type':'application/json','authorization':\"bearer \".concat(API_TOKEN)}}).then(function(res){if(!res.ok){// get the error message from the response\nreturn res.json().then(function(error){// then throw it\nthrow error;});}_this3.props.handleAddTrip(iframe,tripName,tripTravelers,tripDates,userid);_this3.props.getTrips(e);});_this3.props.routerProps.history.push(\"/my-trips\");};var createStartDate=function createStartDate(startDate){_this3.setState({startDate:startDate});};var createEndDate=function createEndDate(endDate){_this3.setState({endDate:endDate});};var validateDate=function validateDate(){var startDate=_this3.state.startDate;var endDate=_this3.state.endDate;if(moment(endDate).isBefore(moment(startDate))===true)return\" hmmm...end date should be later than current date\";};var createTripName=function createTripName(name){_this3.setState({name:name});};var createTravNames=function createTravNames(names){_this3.setState({traveler_names:names});};var travNames=this.state.traveler_names;var checkDupes=function checkDupes(){if(travNames){var arr=travNames.split(re);var duplicate=arr.reduce(function(acc,currentValue,index,array){if(array.indexOf(currentValue)!==index&&!acc.includes(currentValue))acc.push(currentValue);return acc;},[]);if(duplicate.length>0){return'please pick a unique name for the one and only '+duplicate.join(',');}}else return\"\";};var tripName=this.state.name;var selectedTrip=this.state.selectedTrip;var datesArray=selectedTrip[0].trip_dates.toString().replace('{',\"\").replace(\"}\",\"\").replace(/\"/g,\"\").replace(\"\",\"\").replace(/\\s+/g,\"\").trim().split(',');var currentStartDate=/*#__PURE__*/React.createElement(Moment,{format:\"MM/DD/YY\"},datesArray[0]);var currentEndDate=/*#__PURE__*/React.createElement(Moment,{format:\"MM/DD/YY\"},datesArray.pop());var validateTripName=function validateTripName(){if(_this3.props.trips.find(function(trip){return trip.name===tripName;})){return\" \".concat(tripName,\" already exists, please create a different name\");}else return\"\";};var nameCheck=function nameCheck(){return _this3.props.trips.map(function(trip){return trip.name===tripName;});};var checkArray=nameCheck();var dupName=checkArray.includes(true);var startDate=this.state.startDate;var endDate=this.state.endDate;var dateCheck=function dateCheck(){return moment(endDate).isBefore(moment(startDate))===true;};var backDates=dateCheck();var error=function error(){\"duplicate trip name or backwards dates\";};var getTrips=this.props.getTrips;return/*#__PURE__*/React.createElement(\"form\",{className:\"myPlans\",onSubmit:dupName|backDates===true?error:onSubmitForm},/*#__PURE__*/React.createElement(\"h2\",{className:\"white\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-seedling\"}),\"\\xA0\",this.props.text,\"\\xA0\",/*#__PURE__*/React.createElement(GoButton,{username:this.props.username})),/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthPlan\",onMouseOver:getTrips},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"new-trip-name\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-feather white\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"labelWidthPlan white montebello\"},\"New trip name\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"tripName\",maxLength:\"18\",className:\"skinBackground black search\",id:\"new-trip-name\",defaultValue:selectedTrip.length===0?TRIPS[0].name:selectedTrip[0].name,required:true,onChange:function onChange(e){return createTripName(e.target.value);}}),/*#__PURE__*/React.createElement(\"span\",{className:\"error cloudBlue\"},validateTripName()))),/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthPlan\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"traveler-name\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-user-friends white\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"labelWidthPlan white montebello\"},\"Traveler names\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"tripTravelers\",className:\"skinBackground purple names\",defaultValue:selectedTrip.length===0?TRIPS[0].traveler_names:selectedTrip[0].traveler_names.toString().replace('{',\"\").replace(\"}\",\"\").replace(/\"/g,\"\").replace(\"\",\"\").replace(/\\s+/g,\"\").replace(/,/g,\" \").trim().split(','),id:\"traveler-name\",onChange:function onChange(e){return createTravNames(e.target.value);}}),/*#__PURE__*/React.createElement(\"span\",{className:\"error cloudBlue\"},checkDupes()))),/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthPlan\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"map-link\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-drafting-compass white\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"labelWidthPlan white\"},/*#__PURE__*/React.createElement(\"a\",{href:\"https://www.google.com/\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"white montebello\"},\"Website\")),/*#__PURE__*/React.createElement(\"input\",{type:\"url\",name:\"tripURL\",className:\"skinBackground purple names\",defaultValue:selectedTrip[0].iframe,id:\"map-link\"}))),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"dates\"},/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthDates\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"start-date\"},/*#__PURE__*/React.createElement(\"span\",{className:\"white montebello labelWidthPlan \"},\"Start date\",/*#__PURE__*/React.createElement(\"span\",null),\":\\xA0\",/*#__PURE__*/React.createElement(\"span\",null,selectedTrip[0].trip_dates.length<3?\"none set\":currentStartDate)),/*#__PURE__*/React.createElement(\"input\",{type:\"date\",name:\"startDate\",id:\"start-date\",onChange:function onChange(e){return createStartDate(e.target.value);}}),\" \"),\" \",/*#__PURE__*/React.createElement(\"br\",null)),/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthDates\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"end-date\"},/*#__PURE__*/React.createElement(\"span\",{className:\"white montebello labelWidthPlan\"},\"End date\",/*#__PURE__*/React.createElement(\"span\",null),\":\\xA0\",/*#__PURE__*/React.createElement(\"span\",null,selectedTrip[0].trip_dates.length<3?\"none set\":currentEndDate)),/*#__PURE__*/React.createElement(\"input\",{type:\"date\",name:\"endDate\",id:\"end-date\",onChange:function onChange(e){return createEndDate(e.target.value);}}),/*#__PURE__*/React.createElement(\"span\",{className:\"error cloudBlue\"},validateDate())))));}}]);return EditTripForm;}(Component);EditTripForm.defaultProps={trips:[],selectedTrip:TRIPS[0],name:TRIPS[0].name};export default withRouter(EditTripForm);","map":{"version":3,"sources":["/Users/Stephanie/coding/ultrayumm-fs-app/src/AddTrip/EditTripForm.js"],"names":["React","Component","GoButton","withRouter","config","TRIPS","Auth","Moment","EditTripForm","props","selectedTrip","state","startDate","endDate","name","id","username","length","currentAuthenticatedUser","then","user","attributes","sub","getUser","setState","moment","require","re","userid","onSubmitForm","e","preventDefault","iframe","target","tripURL","value","tripName","tripTravelers","split","getDates","dateArray","currentDate","push","format","add","tripDates","inputValues","traveler_names","trip_dates","API","API_UY_ENDPOINT","endpoint","endpointT","url","API_TOKEN","API_UY_KEY","fetch","method","body","JSON","stringify","headers","res","ok","json","error","handleAddTrip","getTrips","routerProps","history","createStartDate","createEndDate","validateDate","isBefore","createTripName","createTravNames","names","travNames","checkDupes","arr","duplicate","reduce","acc","currentValue","index","array","indexOf","includes","join","datesArray","toString","replace","trim","currentStartDate","currentEndDate","pop","validateTripName","trips","find","trip","nameCheck","map","checkArray","dupName","dateCheck","backDates","text","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport '../Font/Font.css';\nimport GoButton from '../FormElements/GoButton';\nimport '../FormElements/FormElements.css';\nimport { withRouter } from \"react-router-dom\";\nimport config from \"../config\";\nimport { TRIPS } from \"../Defaults\";\nimport { Auth } from 'aws-amplify';\nimport Moment from 'react-moment';\n\n\n\n\n\nclass EditTripForm extends Component {\n\n  static defaultProps = {\n    trips: [],\n    selectedTrip: TRIPS[0],\n    name: TRIPS[0].name,\n  };\n\n    constructor(props) {\n    \n        super(props);\n        const selectedTrip = this.props.selectedTrip\n        this.state = {\n          startDate: null,\n          endDate:  null,\n          name: TRIPS[0].name,\n          id: \"\",\n          username: \"\",\n          selectedTrip: selectedTrip.length === 0? TRIPS[0] : selectedTrip\n          \n        }\n      }\n      \n      componentDidMount () { Auth.currentAuthenticatedUser().then(user => {\n        let id = user.attributes.sub\n        let username = user.username\n    \n        this.props.getUser(id, username)\n\n\n        this.setState ({\n          id,\n          username\n        })\n       \n       \n      });\n    \n        }\n\n  render() {\n\n   \n    const moment= require('moment') \n  \n    const  re = /:\\s|\\s/;\n\n    const userid = this.state.id\n    \n    const onSubmitForm = (e) => {\n\n      e.preventDefault();\n\n      let iframe =e.target.tripURL.value\n      let tripName = e.target.tripName.value\n      let tripTravelers = e.target.tripTravelers.value.split(re)\n      \n\n      const  getDates = () => {\n        var dateArray = [];\n        var currentDate = moment(e.target.startDate.value)\n        var endDate = moment(e.target.endDate.value)\n        \n\n        while (currentDate <= endDate) {\n            dateArray.push(moment(currentDate).format())\n            currentDate = moment(currentDate).add(1, 'd');\n        }\n        return dateArray;\n   } \n   \n        let tripDates = [getDates()]\n\n        const inputValues = {\n            name: tripName,\n            iframe: iframe,\n            traveler_names: tripTravelers,\n            trip_dates: tripDates[0],\n            userid: userid\n          }\n\n        const API = config.API_UY_ENDPOINT   \n        const endpoint = config.endpointT\n\n        const url = API + endpoint +`${this.state.selectedTrip[0].id}`;\n \n        const API_TOKEN = config.API_UY_KEY\n\n        fetch(url, {\n          \n            method: this.props.method,\n            body: JSON.stringify(inputValues),\n            headers: {\n              'content-type': 'application/json',\n              'authorization': `bearer ${API_TOKEN}`\n            }\n          }\n          )\n\n        .then(res => {\n        if (!res.ok) {\n            // get the error message from the response\n            return res.json().then(error => {\n            // then throw it\n            throw error\n            })\n        }\n\n        \n        this.props.handleAddTrip(iframe, tripName, tripTravelers, tripDates, userid)\n\n        this.props.getTrips(e)\n      \n        \n        })\n\n        this.props.routerProps.history.push(\"/my-trips\")\n\n      \n    }\n    \n    const createStartDate = (startDate) =>{\n        this.setState({\n            startDate: startDate,\n        });\n      }\n\n\n    const createEndDate = (endDate) =>{\n    this.setState({\n        endDate: endDate,\n    });\n    }\n\n\n    const validateDate = () => {\n        const startDate = this.state.startDate\n        const endDate = this.state.endDate\n        if (moment(endDate).isBefore(moment(startDate)) === true)\n        return (\" hmmm...end date should be later than current date\")\n           \n      }\n\n    const createTripName = (name) =>{\n      this.setState({\n          name: name,\n      });\n      }\n\n    const createTravNames = (names) =>{\n      this.setState({\n          traveler_names: names,\n      });\n      }\n\n    const travNames = this.state.traveler_names\n\n    \n    const checkDupes = () => {\n  \n      if (travNames) {\n        const arr = travNames.split(re)\n        let duplicate = arr.reduce((acc,currentValue,index, array) => {\n          if(array.indexOf(currentValue)!==index && !acc.includes(currentValue)) acc.push(currentValue);\n          return acc;\n        }, []);\n\n       \n        if (duplicate.length>0) {return ('please pick a unique name for the one and only ' + duplicate.join(','))}\n    \n    } \n    \n      else return (\"\")\n    }\n      \n    const tripName = this.state.name\n\n  const selectedTrip = this.state.selectedTrip\n \n  const datesArray = selectedTrip[0].trip_dates.toString().replace('{', \"\").replace(\"}\",\"\").replace(/\"/g,\"\").replace(\"\",\"\").replace(/\\s+/g,\"\").trim().split(',')\n\n\n  const currentStartDate = <Moment format= \"MM/DD/YY\">{datesArray[0]}</Moment>\n  const currentEndDate = <Moment format= \"MM/DD/YY\">{datesArray.pop()}</Moment>\n\n\n    \n    \n    const validateTripName = () => {\n        if (this.props.trips.find((trip) => trip.name === tripName)){\n        return (` ${tripName} already exists, please create a different name`)}\n        else return (\"\")\n           \n      }\n\n      const nameCheck = () => ((this.props.trips.map((trip) => trip.name === tripName)))\n      const checkArray = nameCheck()\n      const dupName = checkArray.includes(true)\n  \n      const startDate = this.state.startDate\n      const endDate = this.state.endDate\n\n      const dateCheck = () => (moment(endDate).isBefore(moment(startDate)) === true)\n      const backDates = (dateCheck())\n\n      const  error = () => {\"duplicate trip name or backwards dates\"}\n\n      \n      const getTrips = this.props.getTrips\n\n    return (\n        <form className= \"myPlans\" onSubmit={dupName | backDates === true? error : onSubmitForm}>\n         <h2 className= \"white\"><i className=\"fas fa-seedling\"></i>&nbsp;{this.props.text}&nbsp;<GoButton\n         username = {this.props.username}\n         /></h2> \n   \n            <div className= \"labelWidthPlan\"\n            onMouseOver = {getTrips}>\n                <label htmlFor= \"new-trip-name\"><i className =\"fas fa-feather white\"></i><span className= \"labelWidthPlan white montebello\">New trip name</span>\n                    <input type=\"text\" name=\"tripName\" \n                    maxLength= \"18\"\n                    className=\"skinBackground black search\" id= \"new-trip-name\"  defaultValue = {selectedTrip.length === 0 ? TRIPS[0].name : selectedTrip[0].name} required                    onChange={e => createTripName(e.target.value)}\n                    /><span className= \"error cloudBlue\">{validateTripName()}</span>\n                </label>\n            </div>\n\n            <div className= \"labelWidthPlan\">\n                 <label htmlFor= \"traveler-name\"><i className =\"fas fa-user-friends white\"></i><span className= \"labelWidthPlan white montebello\">Traveler names</span>\n                 <input type=\"text\" name=\"tripTravelers\" className= \"skinBackground purple names\" \n                 defaultValue = {selectedTrip.length === 0 ? TRIPS[0].traveler_names : selectedTrip[0].traveler_names.toString().replace('{', \"\").replace(\"}\",\"\").replace(/\"/g,\"\").replace(\"\",\"\").replace(/\\s+/g,\"\").replace(/,/g , \" \").trim().split(',')}\n                 id= \"traveler-name\"\n                 onChange={e => createTravNames(e.target.value)}\n                 \n                 /><span className= \"error cloudBlue\">{checkDupes()}</span>\n                </label>\n            </div>\n            <div className= \"labelWidthPlan\">\n                 <label htmlFor= \"map-link\"><i className =\"fas fa-drafting-compass white\"></i><span className= \"labelWidthPlan white\"><a href= \"https://www.google.com/\" target= \"_blank\" rel=\"noopener noreferrer\" className= \"white montebello\">Website</a></span>\n                 <input type=\"url\" name=\"tripURL\" className= \"skinBackground purple names\"   defaultValue = {selectedTrip[0].iframe} id= \"map-link\"/>  \n                </label>\n            </div><br></br>\n\n            <div className= \"dates\">\n                <div className= \"labelWidthDates\">\n    <label htmlFor= \"start-date\"><span className= \"white montebello labelWidthPlan \">Start date<span></span>:&nbsp;<span>{selectedTrip[0].trip_dates.length < 3  ? \"none set\" : currentStartDate}</span></span> \n                <input type=\"date\" name=\"startDate\" \n                id= \"start-date\"\n                onChange={e => createStartDate(e.target.value)}\n                \n                /> </label> <br></br>\n\n            </div>\n            <div className= \"labelWidthDates\">\n                <label htmlFor= \"end-date\"><span className= \"white montebello labelWidthPlan\">End date<span></span>:&nbsp;<span>{selectedTrip[0].trip_dates.length < 3  ? \"none set\" : currentEndDate}</span></span> \n                <input type=\"date\" name=\"endDate\" id= \"end-date\"\n                onChange={e => createEndDate(e.target.value)}\n                /><span className= \"error cloudBlue\">{validateDate()}</span></label>\n            </div>\n           </div>\n       \n        </form>\n        \n   )}\n  \n}\n\n\n\nexport default withRouter(EditTripForm)"]},"metadata":{},"sourceType":"module"}