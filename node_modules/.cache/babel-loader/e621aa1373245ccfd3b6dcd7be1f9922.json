{"ast":null,"code":"import _classCallCheck from\"/Users/Stephanie/coding/ultrayumm-fs-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Stephanie/coding/ultrayumm-fs-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/Stephanie/coding/ultrayumm-fs-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/Stephanie/coding/ultrayumm-fs-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'../Font/Font.css';import GoButton from'../FormElements/GoButton';import'../FormElements/FormElements.css';import{withRouter}from\"react-router-dom\";import config from\"../config\";import{TRIPS,TRIP_NAME,TRAVELER_NAMES}from\"../Defaults\";var AddTripForm=/*#__PURE__*/function(_Component){_inherits(AddTripForm,_Component);var _super=_createSuper(AddTripForm);function AddTripForm(props){var _this;_classCallCheck(this,AddTripForm);_this=_super.call(this,props);_this.state={startDate:null,endDate:null,name:TRIPS[0].name};return _this;}_createClass(AddTripForm,[{key:\"render\",value:function render(){var _this2=this;var moment=require('moment');var re=/:\\s|\\s/;var onSubmitForm=function onSubmitForm(e){e.preventDefault();var iframe=e.target.tripURL.value;var tripName=e.target.tripName.value;var tripTravelers=e.target.tripTravelers.value.split(re);var userid=1;var getDates=function getDates(){var dateArray=[];var currentDate=moment(e.target.startDate.value);var endDate=moment(e.target.endDate.value);while(currentDate<=endDate){dateArray.push(moment(currentDate).format());currentDate=moment(currentDate).add(1,'d');}return dateArray;};var tripDates=[getDates()];var inputValues={name:tripName,iframe:iframe,traveler_names:tripTravelers,trip_dates:tripDates[0],userid:userid};var API=config.API_UY_ENDPOINT;var endpoint=config.endpointT;var url=API+endpoint;var API_TOKEN=config.API_UY_KEY;fetch(url,{method:'POST',body:JSON.stringify(inputValues),headers:{'content-type':'application/json','authorization':\"bearer \".concat(API_TOKEN)}}).then(function(res){if(!res.ok){// get the error message from the response\nreturn res.json().then(function(error){// then throw it\nthrow error;});}return res.json();});_this2.props.handleAddTrip(iframe,tripName,tripTravelers,tripDates,userid);_this2.props.routerProps.history.push(\"/my-trips\");};var createStartDate=function createStartDate(startDate){_this2.setState({startDate:startDate});};var createEndDate=function createEndDate(endDate){_this2.setState({endDate:endDate});};var validateDate=function validateDate(){var startDate=_this2.state.startDate;var endDate=_this2.state.endDate;if(moment(endDate).isBefore(moment(startDate))===true)return\" hmmm...end date should be later than current date\";};var createTripName=function createTripName(name){_this2.setState({name:name});};var createTravNames=function createTravNames(names){_this2.setState({traveler_names:names});};var travNames=this.state.traveler_names;var checkDupes=function checkDupes(){if(travNames){var arr=travNames.split(re);var duplicate=arr.reduce(function(acc,currentValue,index,array){if(array.indexOf(currentValue)!==index&&!acc.includes(currentValue))acc.push(currentValue);return acc;},[]);if(duplicate.length>0){return'please pick a unique name for the one and only '+duplicate.join(',');}}else return\"\";};var tripName=this.state.name;var validateTripName=function validateTripName(){if(_this2.props.trips.find(function(trip){return trip.name===tripName;})){return\" this nice trip name already exists, please pick a different name\";}else return\"\";};var nameCheck=function nameCheck(){return _this2.props.trips.map(function(trip){return trip.name===tripName;});};var checkArray=nameCheck();var dupName=checkArray.includes(true);var startDate=this.state.startDate;var endDate=this.state.endDate;var dateCheck=function dateCheck(){return moment(endDate).isBefore(moment(startDate))===true;};var backDates=dateCheck();var error=function error(){\"duplicate trip name or backwards dates\";};return/*#__PURE__*/React.createElement(\"form\",{className:\"planTrip\",onSubmit:dupName|backDates===true?error:onSubmitForm},/*#__PURE__*/React.createElement(\"h2\",{className:\"white\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-shoe-prints\"}),\" Plan a trip! \",/*#__PURE__*/React.createElement(GoButton,null)),/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthPlan\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"new-trip-name\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-feather white\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"labelWidthPlan white montebello\"},\"New trip name\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"tripName\",maxlength:\"12\",className:\"skinBackground black search\",id:\"new-trip-name\",placeholder:TRIP_NAME,required:true,onChange:function onChange(e){return createTripName(e.target.value);}}),/*#__PURE__*/React.createElement(\"span\",{className:\"error cloudBlue\"},validateTripName()))),/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthPlan\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"traveler-name\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-user-friends white\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"labelWidthPlan white montebello\"},\"Traveler names\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"tripTravelers\",className:\"skinBackground purple names\",defaultValue:TRAVELER_NAMES,id:\"traveler-name\",onChange:function onChange(e){return createTravNames(e.target.value);}}),/*#__PURE__*/React.createElement(\"span\",{className:\"error cloudBlue\"},checkDupes()))),/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthPlan\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"map-link\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-drafting-compass white\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"labelWidthPlan white\"},/*#__PURE__*/React.createElement(\"a\",{href:\"https://www.google.com/\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"white montebello\"},\"Website\")),/*#__PURE__*/React.createElement(\"input\",{type:\"url\",name:\"tripURL\",className:\"skinBackground purple names\",defaultValue:TRIPS[0].iframe,id:\"map-link\"}))),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"dates\"},/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthDates\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"start-date\"},/*#__PURE__*/React.createElement(\"span\",{className:\"white montebello labelWidthPlan\"},\"Start date\"),/*#__PURE__*/React.createElement(\"input\",{type:\"date\",name:\"startDate\",id:\"start-date\",onChange:function onChange(e){return createStartDate(e.target.value);}}),\" \"),\" \",/*#__PURE__*/React.createElement(\"br\",null)),/*#__PURE__*/React.createElement(\"div\",{className:\"labelWidthDates\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"end-date\"},/*#__PURE__*/React.createElement(\"span\",{className:\"white montebello labelWidthPlan\"},\"End date\"),/*#__PURE__*/React.createElement(\"input\",{type:\"date\",name:\"endDate\",id:\"end-date\",onChange:function onChange(e){return createEndDate(e.target.value);}}),/*#__PURE__*/React.createElement(\"span\",{className:\"error cloudBlue\"},validateDate())))));}}]);return AddTripForm;}(Component);AddTripForm.defaultProps={trips:[]};export default withRouter(AddTripForm);","map":{"version":3,"sources":["/Users/Stephanie/coding/ultrayumm-fs-app/src/AddTrip/AddTripForm.js"],"names":["React","Component","GoButton","withRouter","config","TRIPS","TRIP_NAME","TRAVELER_NAMES","AddTripForm","props","state","startDate","endDate","name","moment","require","re","onSubmitForm","e","preventDefault","iframe","target","tripURL","value","tripName","tripTravelers","split","userid","getDates","dateArray","currentDate","push","format","add","tripDates","inputValues","traveler_names","trip_dates","API","API_UY_ENDPOINT","endpoint","endpointT","url","API_TOKEN","API_UY_KEY","fetch","method","body","JSON","stringify","headers","then","res","ok","json","error","handleAddTrip","routerProps","history","createStartDate","setState","createEndDate","validateDate","isBefore","createTripName","createTravNames","names","travNames","checkDupes","arr","duplicate","reduce","acc","currentValue","index","array","indexOf","includes","length","join","validateTripName","trips","find","trip","nameCheck","map","checkArray","dupName","dateCheck","backDates","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport '../Font/Font.css';\nimport GoButton from '../FormElements/GoButton';\nimport '../FormElements/FormElements.css';\nimport { withRouter } from \"react-router-dom\";\nimport config from \"../config\";\nimport { TRIPS, TRIP_NAME, TRAVELER_NAMES } from \"../Defaults\";\n\n\nclass AddTripForm extends Component {\n\n  static defaultProps = {\n    trips: []\n  };\n\n    constructor(props) {\n    \n        super(props);\n       \n        this.state = {\n          startDate: null,\n          endDate:  null,\n          name: TRIPS[0].name\n        }\n      }\n      \n\n  render() {\n\n   \n    const moment= require('moment') \n  \n    const  re = /:\\s|\\s/;\n    \n    const onSubmitForm = (e) => {\n\n      e.preventDefault();\n\n      let iframe =e.target.tripURL.value\n      let tripName = e.target.tripName.value\n      let tripTravelers = e.target.tripTravelers.value.split(re)\n      let userid = 1\n\n      const  getDates = () => {\n        var dateArray = [];\n        var currentDate = moment(e.target.startDate.value)\n        var endDate = moment(e.target.endDate.value)\n        \n\n        while (currentDate <= endDate) {\n            dateArray.push(moment(currentDate).format())\n            currentDate = moment(currentDate).add(1, 'd');\n        }\n        return dateArray;\n   } \n   \n        let tripDates = [getDates()]\n\n        const inputValues = {\n            name: tripName,\n            iframe: iframe,\n            traveler_names: tripTravelers,\n            trip_dates: tripDates[0],\n            userid: userid\n          }\n\n        const API = config.API_UY_ENDPOINT   \n        const endpoint = config.endpointT\n\n        const url = API + endpoint;\n        const API_TOKEN = config.API_UY_KEY\n\n        fetch(url, {\n          \n            method: 'POST',\n            body: JSON.stringify(inputValues),\n            headers: {\n              'content-type': 'application/json',\n              'authorization': `bearer ${API_TOKEN}`\n            }\n          }\n          )\n\n        .then(res => {\n        if (!res.ok) {\n            // get the error message from the response\n            return res.json().then(error => {\n            // then throw it\n            throw error\n            })\n        }\n      \n       \n        return res.json()\n        \n        })\n        \n        this.props.handleAddTrip(iframe, tripName, tripTravelers, tripDates, userid)\n    \n        this.props.routerProps.history.push(\"/my-trips\")\n      \n    }\n    \n    const createStartDate = (startDate) =>{\n        this.setState({\n            startDate: startDate,\n        });\n      }\n\n\n    const createEndDate = (endDate) =>{\n    this.setState({\n        endDate: endDate,\n    });\n    }\n\n\n    const validateDate = () => {\n        const startDate = this.state.startDate\n        const endDate = this.state.endDate\n        if (moment(endDate).isBefore(moment(startDate)) === true)\n        return (\" hmmm...end date should be later than current date\")\n           \n      }\n\n    const createTripName = (name) =>{\n      this.setState({\n          name: name,\n      });\n      }\n\n    const createTravNames = (names) =>{\n      this.setState({\n          traveler_names: names,\n      });\n      }\n\n    const travNames = this.state.traveler_names\n\n    \n    const checkDupes = () => {\n  \n      if (travNames) {\n        const arr = travNames.split(re)\n        let duplicate = arr.reduce((acc,currentValue,index, array) => {\n          if(array.indexOf(currentValue)!==index && !acc.includes(currentValue)) acc.push(currentValue);\n          return acc;\n        }, []);\n\n       \n        if (duplicate.length>0) {return ('please pick a unique name for the one and only ' + duplicate.join(','))}\n    \n    } \n    \n      else return (\"\")\n    }\n      \n    const tripName = this.state.name\n    \n    \n    const validateTripName = () => {\n        if (this.props.trips.find((trip) => trip.name === tripName)){\n        return (\" this nice trip name already exists, please pick a different name\")}\n        else return (\"\")\n           \n      }\n\n      const nameCheck = () => ((this.props.trips.map((trip) => trip.name === tripName)))\n      const checkArray = nameCheck()\n      const dupName = checkArray.includes(true)\n  \n      const startDate = this.state.startDate\n      const endDate = this.state.endDate\n\n      const dateCheck = () => (moment(endDate).isBefore(moment(startDate)) === true)\n      const backDates = (dateCheck())\n\n      const  error = () => {\"duplicate trip name or backwards dates\"}\n\n    \n\n    return (\n        <form className= \"planTrip\" onSubmit={dupName | backDates === true? error : onSubmitForm}>\n         <h2 className= \"white\"><i className =\"fas fa-shoe-prints\"></i> Plan a trip! <GoButton\n         /></h2> \n   \n            <div className= \"labelWidthPlan\">\n                <label htmlFor= \"new-trip-name\"><i className =\"fas fa-feather white\"></i><span className= \"labelWidthPlan white montebello\">New trip name</span>\n                    <input type=\"text\" name=\"tripName\" \n                    maxlength=\"12\"\n                    className=\"skinBackground black search\" id= \"new-trip-name\"  placeholder = {TRIP_NAME} required                    onChange={e => createTripName(e.target.value)}\n                    /><span className= \"error cloudBlue\">{validateTripName()}</span>\n                </label>\n            </div>\n\n            <div className= \"labelWidthPlan\">\n                 <label htmlFor= \"traveler-name\"><i className =\"fas fa-user-friends white\"></i><span className= \"labelWidthPlan white montebello\">Traveler names</span>\n                 <input type=\"text\" name=\"tripTravelers\" className= \"skinBackground purple names\" \n                 defaultValue = {TRAVELER_NAMES}\n                 id= \"traveler-name\"\n                 onChange={e => createTravNames(e.target.value)}\n                 \n                 /><span className= \"error cloudBlue\">{checkDupes()}</span>\n                </label>\n            </div>\n            <div className= \"labelWidthPlan\">\n                 <label htmlFor= \"map-link\"><i className =\"fas fa-drafting-compass white\"></i><span className= \"labelWidthPlan white\"><a href= \"https://www.google.com/\" target= \"_blank\" rel=\"noopener noreferrer\" className= \"white montebello\">Website</a></span>\n                 <input type=\"url\" name=\"tripURL\" className= \"skinBackground purple names\"   defaultValue = {TRIPS[0].iframe} id= \"map-link\"/>  \n                </label>\n            </div><br></br>\n\n            <div className= \"dates\">\n                <div className= \"labelWidthDates\">\n                <label htmlFor= \"start-date\"><span className= \"white montebello labelWidthPlan\">Start date</span>\n                <input type=\"date\" name=\"startDate\" \n                id= \"start-date\"\n                onChange={e => createStartDate(e.target.value)}\n                \n                /> </label> <br></br>\n\n            </div>\n            <div className= \"labelWidthDates\">\n                <label htmlFor= \"end-date\"><span className= \"white montebello labelWidthPlan\">End date</span>\n                <input type=\"date\" name=\"endDate\" id= \"end-date\"\n                onChange={e => createEndDate(e.target.value)}\n                /><span className= \"error cloudBlue\">{validateDate()}</span></label>\n            </div>\n           </div>\n       \n        </form>\n        \n   )}\n  \n}\n\n\n\nexport default withRouter(AddTripForm)"]},"metadata":{},"sourceType":"module"}